---
title: "HTB Walkthrough: Beep"
date: 2022-05-03T01:23:30-04:00 
categories:
  - HackTheBox
header:
  teaser: /assets/images/HTB/beep/beep.png
tags:
  - Easy
  - LFI
  - SMTP
  - PHP
  - RCE
  - Public Vulnerabilities
---

![Beep Logo](/assets/images/HTB/beep/beep.png){: .align-center}

**Welcome** to this walkthrough for the [Hack The Box](https://www.hackthebox.com/) machine Beep. This one is listed as a 'easy' box and has also been retired, so access is only provided to those that have purchased VIP access to HTB.
Because of this, you may notice that it is necessary to be connected to HTB's VIP VPN server, rather than the free server. To do this, change the dropdown selection in the top right corner where you select "Connect"
to "VIP" and download the .ovpn package (yes, even as a paid user, you must toggle between free and paid VPN packages depending on the machine).

---

## Service Enumeration  

I went ahead and started my NMap scan and then plugged the IP address into the browser to check for HTTP and HTTPS respectfully: **10.10.10.7:80** & **10.10.10.7:443**

```bash
sudo nmap -sS -A -sV -T5 -p- 10.10.10.7 | tee nmap_full.txt
dirb http://10.10.10.7/ /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt | tee dirb.log
nikto -h "http://10.10.10.7/" | tee nikto.log 
```
HTTP redirects us to an HTTPS home page hosting an Elastix login form. 

### NMap Results :  

The first thing I noticed was the wide array of public-facing services on this machine.  
In fact, the only part of this box I found difficult was the overwhelming amount of services to enumerate.  

Take a look at the open TCP ports:  

```
22/tcp    open  ssh        OpenSSH 4.3 (protocol 2.0)
25/tcp    open  smtp       Postfix smtpd
80/tcp    open  http       Apache httpd 2.2.3
110/tcp   open  pop3       Cyrus pop3d 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4
111/tcp   open  rpcbind    2 (RPC #100000)
143/tcp   open  imap       Cyrus imapd 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4
443/tcp   open  ssl/http   Apache httpd 2.2.3 ((CentOS))
878/tcp   open  status     1 (RPC #100024)
993/tcp   open  ssl/imap   Cyrus imapd
995/tcp   open  pop3       Cyrus pop3d
3306/tcp  open  mysql      MySQL (unauthorized)
4190/tcp  open  sieve      Cyrus timsieved 2.3.7-Invoca-RPM-2.3.7-7.el5_6.4 (included w/cyrus imap)
4445/tcp  open  upnotifyp?
4559/tcp  open  hylafax    HylaFAX 4.3.10
5038/tcp  open  asterisk   Asterisk Call Manager 1.1
10000/tcp open  http       MiniServ 1.570 (Webmin httpd)

```

### Dirb Results :  

I actually only snagged a few directories from this scan because Dirb seemed to be running extremely slowly on this box.  
In fact, trying to run other directory busters like ffuf or dirbuster didn't work at all due to unusual TLS signatures.  

Here are the directories that Dirb returned before I killed it:  

```
==> DIRECTORY: https://10.10.10.7/images/                                                                          
==> DIRECTORY: https://10.10.10.7/help/                                                                            
==> DIRECTORY: https://10.10.10.7/themes/                                                                          
==> DIRECTORY: https://10.10.10.7/modules/                                                                         
==> DIRECTORY: https://10.10.10.7/mail/                                                                            
==> DIRECTORY: https://10.10.10.7/admin/                                                                           
==> DIRECTORY: https://10.10.10.7/static/                                                                          
==> DIRECTORY: https://10.10.10.7/lang/                                                                            
==> DIRECTORY: https://10.10.10.7/var/                                                                             
==> DIRECTORY: https://10.10.10.7/panel/                                                                           
==> DIRECTORY: https://10.10.10.7/libs/                                                                            
==> DIRECTORY: https://10.10.10.7/recordings/ 
```
Ooh... /admin/ 				**(. ) (. )**  

### Nikto Results :  

```
+ Server: Apache/2.2.3 (CentOS)
+ Cookie elastixSession created without the secure flag
+ Cookie elastixSession created without the httponly flag
+ Retrieved x-powered-by header: PHP/5.1.6
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The site uses SSL and the Strict-Transport-Security HTTP header is not defined.
+ The site uses SSL and Expect-CT header is not present.
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ Server may leak inodes via ETags, header found with file /robots.txt, inode: 889199, size: 28, mtime: Fri Jan  8 00:43:28 2072
+ Hostname '10.10.10.7' does not match certificate's names: localhost.localdomain
+ OSVDB-630: The web server may reveal its internal or real IP in the Location header via a request to /images over HTTP/1.0. The value is "127.0.0.1".
+ Apache/2.2.3 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE 
+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.
+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST
+ /help/: Help directory should not be accessible
+ Cookie PHPSESSID created without the secure flag
+ Cookie PHPSESSID created without the httponly flag
+ /config.php: PHP Config file may contain database IDs and passwords.
+ OSVDB-12184: /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ OSVDB-12184: /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ OSVDB-12184: /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
+ OSVDB-3092: /mail/: This might be interesting...
+ OSVDB-3268: /icons/: Directory indexing found.
+ OSVDB-3268: /images/: Directory indexing found.
+ OSVDB-3268: /static/: Directory indexing found.
+ OSVDB-3233: /icons/README: Apache default file found.
+ /panel/: Admin login page/section found.
```

